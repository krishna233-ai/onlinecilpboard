<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Online Clipboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #020617;
  --card: #0f172a;
  --accent: #38bdf8;
  --success: #22c55e;
}
*{box-sizing:border-box}
body{
  margin:0;height:100vh;
  background:radial-gradient(circle at top,#0ea5e9,#020617 65%);
  font-family:Poppins,system-ui;
  display:flex;align-items:center;justify-content:center;
  color:#fff;
}
.container{
  width:95%;max-width:420px;
  background:var(--card);
  padding:24px;border-radius:22px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
  max-height:90vh;overflow:auto;
}
h2{text-align:center}
.key-box{
  background:#020617;padding:14px;
  border-radius:14px;text-align:center;
  font-size:1.6rem;letter-spacing:4px;
  color:var(--accent);
}
textarea,input,button{
  width:100%;margin-top:10px;
  padding:14px;border-radius:14px;
  border:none;outline:none;
}
textarea{height:110px;resize:none}
button{cursor:pointer;font-weight:600}
.save{background:var(--accent);color:#000}
.get{background:var(--success);color:#000}
.result{
  display:none;margin-top:15px;
  background:#020617;padding:14px;
  border-radius:14px;
  max-height:220px;overflow:auto;
  white-space:pre-wrap;
}
.copy{display:none;background:#a855f7;color:#fff}
.company-tag{
  position:fixed;bottom:16px;right:16px;
  background:rgba(15,23,42,.9);
  padding:10px 14px;border-radius:999px;
  font-size:.75rem;font-weight:600;
}
.company-tag span{color:#22c55e}
</style>
</head>

<body>

<div class="container">
<h2>üìã Online Clipboard</h2>

<div class="key-box" id="generatedKey">---</div>

<textarea id="text" placeholder="Paste your text here..."></textarea>
<button class="save" onclick="saveText()">Save & Generate Key</button>

<hr>

<input id="getKey" placeholder="Enter 3-digit key">
<button class="get" onclick="getText()">Get Text</button>

<div id="resultBox" class="result"></div>
<button id="copyBtn" class="copy" onclick="copyText()">üìã Copy Text</button>

<small>‚è≥ Auto deletes after 24 hours</small>
</div>

<div class="company-tag">¬© <span>NSK TECH SOLUTIONS</span></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, doc, setDoc, getDoc, deleteDoc, Timestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDnl0MtGtboKE01LWn15Mxj2eMdIUkwMWU",
  authDomain: "online-clipboard-in.firebaseapp.com",
  projectId: "online-clipboard-in",
  storageBucket: "online-clipboard-in.firebasestorage.app",
  messagingSenderId: "820812677584",
  appId: "1:820812677584:web:882fa6a82bcb2493c4b9d5"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let currentText = "";

// üî• 3-digit key generator
function generateKey() {
  return Math.floor(100 + Math.random() * 900).toString();
}

window.saveText = async () => {
  const text = document.getElementById("text").value.trim();
  if (!text) return alert("Enter text");

  const key = generateKey();
  const now = Timestamp.now();
  const expiresAt = Timestamp.fromMillis(
    now.toMillis() + 24 * 60 * 60 * 1000
  );

  await setDoc(doc(db, "clipboard", key), {
    text,
    createdAt: now,
    expiresAt   // üî• TTL field
  });

  document.getElementById("generatedKey").innerText = key;
  document.getElementById("text").value = "";
};

window.getText = async () => {
  const key = document.getElementById("getKey").value.trim();
  if (!key) return alert("Enter key");

  const ref = doc(db, "clipboard", key);
  const snap = await getDoc(ref);

  if (!snap.exists()) return alert("Invalid or expired key");

  const data = snap.data();

  if (data.expiresAt.toMillis() < Timestamp.now().toMillis()) {
    await deleteDoc(ref);
    return alert("Key expired");
  }

  currentText = data.text;
  const box = document.getElementById("resultBox");
  box.style.display = "block";
  box.textContent = currentText;
  document.getElementById("copyBtn").style.display = "block";
};

window.copyText = async () => {
  await navigator.clipboard.writeText(currentText);
  alert("Text copied!");
};
</script>

</body>
</html>
